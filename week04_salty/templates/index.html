<!doctype html>
<html lang="ko">

<head>
    <!-- Required meta tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>

    <!--    google web fonts-->
    <link href="https://fonts.googleapis.com/css2?family=Poor+Story&display=swap" rel="stylesheet">

    <title> ğŸ§í­ìˆ˜ ì•„ìŠˆí¬ë¦¼ğŸ§ | ë¶€íŠ¸ìŠ¤íŠ¸ë© ì—°ìŠµí•˜ê¸°</title>

    <style>
        * {
            font-family: 'Poor Story', cursive;
        }

        .wrap {
            border: black solid;
            width: 600px;
            margin: 30px auto;
            padding: 30px;
            text-align: left;
        }

        .pengsoo_image {
            margin: 30px;
        }

        .float {
            float: left;
        }

        #exchange_rate {
            color: blue;
        }
        #table {
            border: solid black;
        }
        #order_count {
            color: blue;
            font-weight: bold;
        }
    </style>

    <script>
        $(document).ready(function () {
            $("#table_box").empty();
            upload();
            exchange_rate();
            order_count();
        });

        function exchange_rate() {
            $.ajax({
                type: "GET", // GET ë°©ì‹ìœ¼ë¡œ ìš”ì²­í•œë‹¤.
                url: "https://api.manana.kr/exchange/rate.json",
                data: {}, // ìš”ì²­í•˜ë©´ì„œ í•¨ê»˜ ì¤„ ë°ì´í„° (GET ìš”ì²­ì‹œì—” ë¹„ì›Œë‘ì„¸ìš”)
                success: function (response) { // ì„œë²„ì—ì„œ ì¤€ ê²°ê³¼ë¥¼ responseë¼ëŠ” ë³€ìˆ˜ì— ë‹´ìŒ
                    let dollar_won = response[1]['rate'];
                    $('#exchange_rate').append(dollar_won);
                }
            })
        }

        function upload() {
//2. ì„œë²„->í´ë¼ì´ì–¸íŠ¸ ì£¼ë¬¸ë‚´ì—­ ë¶ˆëŸ¬ì˜¤ê¸°
            $.ajax({
                //1.ì„œë²„->í´ë¼ì´ì–¸íŠ¸ ì£¼ë¬¸ë‚´ì—­(ì´ë¦„ ìˆ˜ëŸ‰ ì£¼ì†Œ ì „í™”ë²ˆí˜¸)ë°›ì•„ì˜¤ê¸°
                type: "GET",
                url: "/order",
                data: {},
                success: function (response) {
                    let order = response['orders']
                    for (let i = 0; i < order.length; i++) {
                        let name = order[i]['name']
                        let number = order[i]['number']
                        let address = order[i]['address']
                        let phone = order[i]['phone']
                        order_data = `<tr>
                                        <td>${name}</td>
                                        <td>${number}</td>
                                        <td>${address}</td>
                                        <td>${phone}</td>
                                    </tr>`
                        $('#table_box').append(order_data)

                    }
                    if (response['result'] == 'success') {
                        alert(response['msg'])
                    }
                }
            })
        }

        function order() {
            let input_phone = $('#order_phone').val();
            let check_phone = input_phone.split('-');
            if ($('#order_name').val() == '') {
                alert("ì„±í•¨ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            } else if ($('#order_number').val() == '') {
                alert("ìˆ˜ëŸ‰ì„ ì„ íƒí•´ì£¼ì„¸ìš”.")
            } else if ($('#order_adress').val() == '') {
                alert("ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            } else if ($('#order_phone').val() == '') {
                alert("ì „í™”ë²ˆí˜¸ë¥¼ 010-0000-0000 í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            } else if (check_phone[0] != '010') {
                alert("ì „í™”ë²ˆí˜¸ í˜•ì‹ì´ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤. 010-0000-0000 í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•´ ì£¼ì„¸ìš”.")
            } else if (isNaN(check_phone[1]) == true || check_phone[1].length != 4) {
                alert("ì „í™”ë²ˆí˜¸ í˜•ì‹ì´ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤. 010-ë„¤ ìë¦¬ ìˆ«ì ë¡œ ì…ë ¥í•´ ì£¼ì„¸ìš”.")
            } else if (isNaN(check_phone[2]) == true || check_phone[2].length != 4) {
                alert("ì „í™”ë²ˆí˜¸ í˜•ì‹ì´ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤. 010-ë„¤ ìë¦¬ ìˆ«ì-ë„¤ ìë¦¬ ìˆ«ì ë¡œ ì…ë ¥í•´ ì£¼ì„¸ìš”.")
                // íœ´ëŒ€í°ë²ˆí˜¸ ê²€ì‚¬
                // ì „í™”ë²ˆí˜¸ì— ìˆ«ìë„£ì–´ì•¼ -> ë¬¸ì ë„£ìœ¼ë©´ ì–¼ëŸ¿
                // ì²«ë²ˆì§¸ 010 ë„£ì–´ì•¼ -> 010 ì•„ë‹ˆë©´ ì–¼ëŸ¿
                // ë‘ë²ˆì§¸ ìˆ«ì 4ìë¦¬ ë„£ì–´ì•¼ -> ë¬¸ìì´ë©´ && ?? || ?? 4ìë¦¬ ì•„ë‹ˆë©´ ì–¼ëŸ¿ (ë¬¸ìì—¬ë„, ìˆ«ì4ìë¦¬ ì•„ë‹ˆì–´ë„)
                // ì„¸ë²ˆì§¸ ìˆ«ì 4ìë¦¬ ë„£ì–´ì•¼ -> ë¬¸ìì´ë©´ && ?? || ?? 4ìë¦¬ ì•„ë‹ˆë©´ ì–¼ëŸ¿
            } else {
                order_upload()
            }
        }

        function order_upload() {
            let order_name = $('#order_name').val()
            let order_number = $('#order_number').val()
            let order_address = $('#order_adress').val()
            let order_phone = $('#order_phone').val()
            $.ajax({
                //1.í´ë¼ì´ì–¸íŠ¸->ì„œë²„ ì£¼ë¬¸ë‚´ì—­(ì´ë¦„ ìˆ˜ëŸ‰ ì£¼ì†Œ ì „í™”ë²ˆí˜¸) ë³´ë‚´ê¸°
                type: "POST",
                url: "/order",
                data: {'name': order_name, 'number': order_number, 'address': order_address, 'phone': order_phone},
                success: function (response) {
                    if (response['result'] == 'success') {
                        alert(response['msg'])
                    }
                    window.location.reload()
                }
            })

        }

        function order_count() {
            $.ajax({
                type: "GET",
                url: "/order",
                data: {},
                success: function (response) {
                    let order = response['orders'].length;
                    $('#order_count').append(order)
                }
            })
        }

    </script>

</head>

<body>
<div class="wrap">

    <img class="pengsoo_image"
         src="https://post-phinf.pstatic.net/MjAyMDA3MDFfMjMx/MDAxNTkzNTcwODU3NjU3.nnmy2GIjYmeHBxtH54U9yfNiDmRZyKGuyIQlq7mfAwgg.RemeBHNInZ_VQi3axn4DXk0RID9RASP_PpEOyXdwvPsg.JPEG/%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C_%285%29.jpg?type=w1200"
         alt="í­ìˆ˜ ì•„ìŠˆí¬ë¦¼ ì´ë¯¸ì§€" width="400">
    <div>
        <div class="float">
            <h1>í­ìˆ˜ ì•„ìŠˆí¬ë¦¼</h1>
        </div>
        <p>
            ê°€ê²©: 3,200ì›/ê°œ
        </p>
        <br>
        <h5>"ì°¾ì•˜ë‹¤! ìš°ì£¼ì—ì„œ ì œì¼ ë§›ìˆëŠ” í­ìˆ˜ ì•„ìŠˆí¬ë¦¼!"</h5>
        <p>
            ë°°ìŠ¤í‚¨ë¼ë¹ˆìŠ¤ì˜ 2020ë…„ 7ì›” ì´ ë‹¬ì˜ ë§›!<br>
            "í­ìˆ˜ ì•„ìŠˆí¬ë¦¼" (Pengsoo Choux Ice Cream)ì…ë‹ˆë‹¤.<br>
            ë°€í¬ì´ˆì½œë¦¿ & ì»¤ìŠ¤í„°ë“œí–¥ ì•„ì´ìŠ¤í¬ë¦¼ì—, ìŠˆí¬ë¦¼ ì‹œëŸ½ê³¼ ë‹¤ì´ì œë³¼(ì´ˆì½”ë³¼)ì´ ë“¤ì–´ ìˆì–´ìš”.<br>
            ë‹¬ì½¤í•˜ê³  ë¶€ë“œëŸ¬ìš´ ì´ˆì½œë¦¿&ìŠˆí¬ë¦¼ì˜ ë§¤ë ¥ì— í‘¹ ë¹ ì ¸ë³´ì„¸ìš”~
        </p>
        <p>*í­ìˆ˜ ì•„ìŠˆí¬ë¦¼ì€ ì‹œì¦Œ í”Œë ˆì´ë²„ë¡œ, ì¬ê³  ì†Œì§„ì‹œ ìë™ìœ¼ë¡œ íŒë§¤ê°€ ì¢…ë£Œë©ë‹ˆë‹¤.</p>
        <p>*ì¬ê³  ë¬¸ì˜ëŠ” ê°€ê¹Œìš´ ë§¤ì¥ìœ¼ë¡œ ë¶€íƒë“œë¦½ë‹ˆë‹¤.</p>
    </div>
    <div id="exchange_rate">
        ë‹¬ëŸ¬-ì› í™˜ìœ¨ :
    </div>
    <br><br>
    <div>
        <h1>ì£¼ë¬¸í•˜ê¸°</h1>
        <p>ì£¼ë¬¸ì ì´ë¦„: <input type="text" id="order_name"></p>
        <p>ì£¼ë¬¸ ìˆ˜ëŸ‰ :
            <input type="number" id="order_number" placeholder="--ìˆ˜ëŸ‰ì„ ì…ë ¥í•˜ì„¸ìš”--">
        </p>
        <p>ì£¼ë¬¸ì ì£¼ì†Œ : <input type="text" id="order_adress"></p>
        <p>ì£¼ë¬¸ì ì „í™”ë²ˆí˜¸ : <input type="text" id="order_phone"></p>
        <button onclick="order()" id="order_button" type="button" class="btn btn-warning">
            í­ìˆ˜ ì•„ìŠˆí¬ë¦¼ ì£¼ë¬¸í•˜ê¸°!
        </button>
    </div>
    <br><br>
    <div>
        <h1>ì£¼ë¬¸ì ëª©ë¡</h1>
        <p>ì™€! ë²Œì¨ <span id="order_count"></span>ëª…ì´ ì£¼ë¬¸í–ˆì–´ìš”!</p>
        <table id="table">
            <thead>
            <tr>
                <th>ì´ë¦„</th>
                <th>ìˆ˜ëŸ‰</th>
                <th>ì£¼ì†Œ</th>
                <th>ì „í™”ë²ˆí˜¸</th>
            </tr>
            </thead>
            <tbody id="table_box">
            <tr>
                <td>ì´ë¦„ì´ë¦„</td>
                <td>ìˆ˜ëŸ‰ìˆ˜ëŸ‰</td>
                <td>ì£¼ì†Œì£¼ì†Œ</td>
                <td>ì „í™”ë²ˆí˜¸ë²ˆí˜¸</td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
</body>
</html>

